let yes_no=["No","Yes"],license=localizer.license,field_seperator=";",settings_prefix="provider_settings__",default_line_format="P-N",default_delay=+jQuery("#delay-box").children("option:selected").val();class LwJs{static _v="LwJs v2.0.0 - macLeen 01-2024";static reserved=["__engine_type__"];static _available_storage_engines={session:window.sessionStorage,permanent:window.localStorage};constructor(){this.version=LwJs._v,this.available_storage_engines=Object.keys(LwJs._available_storage_engines)}#composed(t,n){return function(...e){return t(n(...e))}}#piped(t,n){return function(...e){return n(t(...e))}}compose(...e){return e.reduce(this.#composed)}pipe(...e){return e.reduce(this.#piped)}is_callable(e){return["[object AsyncFunction]","[object Function]"].includes(Object.prototype.toString.call(e))||"function"==typeof e||e instanceof Function}is_promise(e){return"promise"===this.type_of(e)||this.is_callable(e.then)}clone(e){var t;return Object.assign(t,...e),t}type_of(e){return[void 0,"undefined",null].includes(e)?e:new RegExp("\\[.+ (.+)\\]").exec({}.toString.call(e).toLowerCase())[1]}storage_engine(n){let r=this;if(n in LwJs._available_storage_engines){let s=LwJs._available_storage_engines[n];return new Proxy({},{deleteProperty(e,t){if(LwJs.reserved.includes(t))throw new Error(`access denied, ${t} is a reserved word.`);return"all"===t?s.clear():s.removeItem(t)},get(e,t){return"__engine_type__"===t?n:s.getItem(t)??"undefined"},set(e,t,n){if(LwJs.reserved.includes(t))throw new Error(`access denied, ${t} is a reserved word.`);if("string"!=r.type_of(t)||"string"!=r.type_of(n))throw new Error("Unsupported type. Both key and value must be strings.");return s.setItem(t,n)}})}throw new Error("Engine type is unavailable")}random_number(e){return Number(String(Math.random()).replace("0.","").substr(0,e??20))}random_segment_number(e){return Math.floor(Math.random()*Math.pow(10,e))}random_array_element(e){return(e="array"===this.type_of(e)?e:[e])[this.random_segment_number(e.length)]}shuffle_array(e){return e=1<(e=Array.isArray(e)?e:[e]).length?e.sort(function(){return Math.random()-.5}):e}async_delay(n){return function(t){return new Promise(e=>setTimeout(()=>e(t),n))}}is_array(e){return Boolean("array"===this.type_of(e))}assert_is_array(e){return this.is_array(e)?e:[e]}is_key(n){let s=["boolean","object","string","number","array"];return{in:e=>{var t=this.type_of(e);if(!s.includes(t))throw new Error("is_key.in function does not support that container type");switch(this.type_of(e)){case"boolean":return e===n;case"array":return e.includes(n);case"object":return n in e;case"string":return e.includes(n.toString());case"number":return e.toString().includes(n.toString())}}}}map(e,n){return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,n(t)]))}}window.macleen_LwJs=LwJs;class Gauge{constructor(e){if(isNaN(e)||e<1)throw new Error("Delay must be a whole non-zero number");this.totalSegments=e,this.singleSegmentWidth=100/this.totalSegments,this.domGauge=jQuery("#gauge-meter"),this.domCountdown=jQuery("#delay-timer-countdown"),this.reset()}draw(e){e=Math.max(0,Math.min(e,this.totalSegments)),this.domGauge.css("width",e*this.singleSegmentWidth+"%"),this.domCountdown.text(Number(e).toFixed(0))}reset(){this.draw(0)}stop(){this.reset()}updateUI(e){this.draw(e)}}class Ajax{static instance;static RETHROW_ERRORS=!1;constructor(){if(Ajax.instance)return Ajax.instance;Ajax.instance=this}get_json_error(e){return!!e.responseJSON&&e.responseJSON.message+" - status: "+e.status}get_text_error(e){return!!e.statusText&&e.statusText+" - status: "+e.status}simplifyError(e){console.error("simplifyError =>>>> ",e);var t=this.get_json_error(e),e=this.get_text_error(e),t=t||e;t&&show_alert("SMS-SENDER ERROR: "+t,"error")}filtered(e){return e}showLoader(){document.querySelectorAll(".package-loader").forEach(e=>e.classList.remove("hidden"))}hideLoader(){document.querySelectorAll(".package-loader").forEach(e=>e.classList.add("hidden"))}show_sending_loader(){jQuery(".loader-container").removeClass(function(){var e=document.getElementById("sound-track");return e.loop=!0,config.get_entry("sound_is_on")&&e.play(),"hidden"})}hide_sending_loader(){jQuery(".loader-container").addClass(function(){return document.getElementById("sound-track").pause(),"hidden"})}sendToServer(e,a=!1){e.url=".."+localizer.ajaxUrl+"/api"+e.url;let n={url:"",method:"GET",data:"",async:!0,crossDomain:!0,timeout:3e4,dataType:"JSON",headers:{"Content-Type":"application/json; charset=UTF-8"},beforeSend:this.showLoader,...e};e=n.data instanceof FormData;return a?(n.dataType=null,n.xhrFields={responseType:"blob"}):e&&(n.processData=!1,n.contentType=!1),new Promise((i,t)=>{jQuery.ajax(n).done((e,t,n)=>{var s,r;a?(n=(n=n.getResponseHeader("Content-Disposition"))?n.split("filename=")[1]?.replace(/"/g,""):"download.pdf",s=new Blob([e],{type:"application/pdf"}),(r=document.createElement("a")).href=window.URL.createObjectURL(s),r.download=n,r.click(),window.URL.revokeObjectURL(r.href),i(s)):i(this.filtered(e))}).fail(e=>{this.simplifyError(e),t()}).always(()=>this.hideLoader())})}get(e,t={},n=!1){return this.sendToServer({...t,url:e,method:"GET"},n)}post(e,t,n={},s=!1){return this.sendToServer({...n,url:e,method:"POST",headers:localizer.nonce?{"X-WP-Nonce":localizer.nonce}:{},data:t},s)}send_message(e){return this.post(`/${config.get_entry("provider")}/send`,e)}get_available_providers(){return this.get("/providers")}get_provider_fields(){return this.get(`/${config.get_entry("provider")}/fields`)}get_balance(e){return this.post(`/${config.get_entry("provider")}/get_balance`,e)}get_account_info(){return this.post(`/${config.get_entry("provider")}/account/info`,config.get_entry("settings"))}install_plugin(e){return this.post("/install/plugin",e)}get_plugins_tree(){return this.get("/installed/plugins")}get_wp_leads(e){return this.get("/users/"+e)}get_available_log_files(){return this.get("/log/all")}get_log_by_date(e){return this.get("/log/date/"+e)}delete_log_by_date(e){return this.get("/log/delete/"+e)}get_available_analytics_files(){return this.get("/analytics/all")}get_analytics_file_by_path(e){return this.post("/analytics/file",{path:e})}delete_analytics_by_path(e){return this.post("/analytics/delete",{path:e})}}class AjaxHttpServer{static instance;constructor(){if(AjaxHttpServer.instance)return AjaxHttpServer.instance;this.http=new Ajax,AjaxHttpServer.instance=this}get_available_providers(){this.http.get_available_providers().then(function(e){if(e&&e.hasOwnProperty("data")&&e.data){var t=e.data,n='<option value="">Select a service provider</option>';if(t.length)for(var s=0;s<t.length;s++)n+='<option value="'+t[s]+'">'+t[s]+"</option>";return jQuery("#service_provider").html(n)}return show_alert("Respose format is inavalid","error")}).catch(show_alert)}get_provider_fields(){this.http.get_provider_fields().then(function(e){e&&e.hasOwnProperty("data")?prepare_provider_fields(e.data):Promise.reject("Invalid server response")}).catch(show_alert)}get_account_info(){return this.http.get_account_info()}install_plugin(e){return this.http.install_plugin(e).then(e=>(new ProviderTree(config).show_plugin_tree(".plugin-tree",!0),e.message))}get_plugins_tree(e){return(e=e||this).http.get_plugins_tree()}get_wp_leads(e){return this.http.get_wp_leads(e)}get_available_log_files(){return this.http.get_available_log_files()}get_log_by_date(e){return this.http.get_log_by_date(e)}delete_log_by_date(e){return this.http.delete_log_by_date(e)}get_available_analytics_files(){return this.http.get_available_analytics_files()}get_analytics_file_by_path(e){return this.http.get_analytics_file_by_path(e)}delete_analytics_by_path(e){return this.http.delete_analytics_by_path(e)}}class Config{static instance;constructor(e,t,n){if(Config.instance)return Config.instance;this.ui=this.#init_ui(),this.pages=this.#init_pages(),this.service_provider=this.#init_service_provider(t),this.processing=this.#init_processing(n,e),this.server=new AjaxHttpServer,this.lw=new LwJs,Config.instance=this}#init_ui(){return{sound_is_on:!1}}#init_service_provider(e){return{provider:"",add_ons:{},settings_prefix:e,settings:{},fields:{}}}#init_pages(){return{provider:!1,"provider-settings":!1,"local-settings":!1,messages:!1,indexes:!1,leads:!1,"tags-settings":!1,preview:!1}}is_accessible_by_jump(e){var t=Object.keys(this.pages),e=t.indexOf(e);return!(0<e)||this.pages[t[e-1]]}set_page_accessibility_by_jump(e,t){e in this.pages&&(this.pages[e]=t)}reset_all_pages_accessibility(){for(var e in this.pages)this.pages[e]=!1}#init_processing(e,t){return{sender_id:"",delay:t,total_leads:0,total_sent:0,total_messages:0,total_indexes:0,index_roll_in:1,index_sending_counter:0,use_shortner_code_as_route_arg:"NO",msg_url_mode:"",message_container:[],index_container:[],current_msg_pointer:-1,current_index_pointer:0,name_format:"FullName",ndx_with_packet_id:!1,language:"EN",random_string_length:10,line_format:e,dial_code_length:"",sending_target_country_code:"",full_country_name:"",remove_successful_items:!0}}set_entry(e,t){this.ui.hasOwnProperty(e)?this.ui[e]=t:this.processing.hasOwnProperty(e)?this.processing[e]=t:this.service_provider.hasOwnProperty(e)&&(this.service_provider[e]=t)}get_entry(e){return this.ui.hasOwnProperty(e)?this.ui[e]:this.processing.hasOwnProperty(e)?this.processing[e]:this.service_provider.hasOwnProperty(e)?this.service_provider[e]:void 0}reviewable_fields(){return["dial_code_length","full_country_name","line_format","delay","sending_target_country_code","provider","msg_url_mode","index_roll_in","name_format","language","total_leads","total_messages","total_indexes","use_shortner_code_as_route_arg"]}get_next_rotation_msg(){var e=this.get_entry("message_container");return e.length?(this.processing.current_msg_pointer++,this.processing.current_msg_pointer>=e.length&&(this.processing.current_msg_pointer=0),e[this.processing.current_msg_pointer]):""}get_next_index_link(){var e=this.get_entry("index_container");return e.length?(this.processing.index_sending_counter<=this.processing.index_roll_in?this.processing.index_sending_counter++:(this.processing.current_index_pointer++,this.processing.index_sending_counter=1),this.processing.current_index_pointer>=e.length&&(this.processing.current_index_pointer=0),e[this.processing.current_index_pointer]):""}}class ProviderTree{static __instance=null;static $treeContainer=null;constructor(e=null){if(ProviderTree.__instance)return ProviderTree.__instance;this.config=e,ProviderTree.__instance=this}static handle_tree_click_event(e,t){t=t.node;t.data.name&&t.data.location?(jQuery("#macleen-selected-purchasable-plugin-show").text(t.data.name),jQuery("#macleen-selected-purchasable-plugin-purchase").attr("data-selected-plugin",t.data.name).attr("data-plugin-location",t.data.location)):(jQuery("#macleen-selected-purchasable-plugin-show").text("None"),jQuery("#macleen-selected-purchasable-plugin-purchase").attr("data-selected-plugin","").attr("data-plugin-location",""))}show_plugin_tree(e,t=!1){e=jQuery(e);ProviderTree.$treeContainer=e,t||ProviderTree.$treeContainer.data("fancytree")?(ProviderTree.$treeContainer.fancytree("destroy"),setTimeout(()=>{this.config.server.get_plugins_tree().then(e=>{var t=e.data.total,e=e.data.source;jQuery("#macleen-installed-plugins").text(t.installed),jQuery("#macleen-purchasable-plugins").text(t.purchasable),ProviderTree.$treeContainer.fancytree({source:e,click:ProviderTree.handle_tree_click_event,extensions:["glyph"],glyph:{preset:"awesome4"}})}).catch(e=>{console.error("Error fetching plugin tree:",e)})},50)):this.config.server.get_plugins_tree().then(e=>{var t=e.data.total,e=e.data.source;jQuery("#macleen-installed-plugins").text(t.installed),jQuery("#macleen-purchasable-plugins").text(t.purchasable),ProviderTree.$treeContainer.fancytree({source:e,click:ProviderTree.handle_tree_click_event,extensions:["glyph"],glyph:{preset:"awesome4"}})}).catch(e=>{console.error("Error fetching plugin tree:",e)})}}class Packet{static char_table=["1","a","3","b","c","d","5","e","7","f"];constructor(e){this.init(e)}init(e){this.config=e,this.line_parts=[],this.line_fields={},this.fixed_packet_parms=this.#init_packet_parms(),this.packet_container=this.#init_packet_container(),this.#set_fixed_parms()}set_entry(e,t){this.fixed_packet_parms.hasOwnProperty(e)?this.fixed_packet_parms[e]=t:this.packet_container.hasOwnProperty(e)&&(this.packet_container[e]=t)}get_entry(e){return this.fixed_packet_parms.hasOwnProperty(e)?this.fixed_packet_parms[e]:this.packet_container.hasOwnProperty(e)?this.packet_container[e]:"undefined"}#init_packet_parms(){return{sender_id:"",dial_code_length:"",sending_target_country_code:"",full_country_name:"",language:"",msg_url_mode:0,ndx_with_packet_id:!1,use_shortner_code_as_route_arg:"NO"}}#init_packet_container(){return{recipient:"",message:"",phone:"",email:"",full_name:"",generic_name:"",address:"",other_info:"",index:""}}#set_fixed_parms(){for(var e in this.fixed_packet_parms)this.fixed_packet_parms[e]=this.config.get_entry(e);this.#set_field_markers()}#convert(e){let t="";return(e=e.trim())&&e.split("").forEach(function(e){void 0!==Packet.char_table[e]?t+=Packet.char_table[e]:t+=e}),t}#set_packet_identifier(){var e=this.packet_container.phone.trim()?this.packet_container.phone:this.packet_container.recipient;return this.#convert(e)}#random_str(){var e=new Uint8Array((this.config.get_entry("random_string_length")||40)/2);return window.crypto.getRandomValues(e),Array.from(e,dec2hex).join("")}#compose_message(){let s=this.config.get_next_rotation_msg();if(s){var e=[/__FULL_NAME__/g,/__PHONE__/g,/__RANDOM_STR__/g,/__ID__/g];let n=[this.packet_container.generic_name,this.packet_container.phone,this.#random_str(),this.#set_packet_identifier()];e.forEach(function(e,t){s=s.replace(e,n[t])})}return s}#set_field_markers(){var e=this.config.get_entry("line_format"),e=(e=e||"P-N").split("-");this.line_fields.phone=e.indexOf("P"),this.line_fields.full_name=e.indexOf("N"),this.line_fields.email=e.indexOf("E"),this.line_fields.address=e.indexOf("A")}#set_generic_name(){var e=this.packet_container.full_name;let t=e;var n=this.config.get_entry("name_format"),s=e.split(" "),r=s.length,n=n||"FullName";if(r)switch(n){case"FirstName":t=s[0];break;case"SecondName":t=1<r?s[1]:s[0];break;case"LastName":t=s[r-1];break;case"skip1st":s.shift(),t=s.length?s.join(" "):recipient_name}return t}#set_packet_container(e){var t,n=this.config.get_entry("index_with_packet_id"),s=[],r=e.split(field_seperator),i=r.length;for(t in this.line_fields){var a=this.line_fields[t];0<=a&&(a=a<i?r[a]:"",a=String(a).trim(),t in this.packet_container?this.packet_container[t]=a:s.push(a))}this.packet_container.generic_name=this.#set_generic_name(),this.packet_container.other_info=s.join("|"),this.packet_container.recipient=this.packet_container.phone,this.packet_container.index=this.config.get_next_index_link()+(n?"/"+this.#set_packet_identifier():""),this.packet_container.message=this.#compose_message()}assemble(e){return(e=e.trim())?(jQuery(".composed-message-container").removeClass("hidden"),this.#set_packet_container(e),{...this.fixed_packet_parms,...this.packet_container,...this.config.get_entry("settings")}):""}sequencer(t){let n=this;return function*(){for(let e=0;e<t.length;e++)if(yield n.assemble(t[e]))return}}}(i=>{var a,o,t=["type","time","sticky","fadeOut","closable","scrollTo","html"],l={appendTo:"body",container:'<div class="flash-messages"></div>',message:'<div class="flash-message {type}">{message}<span class="flash-message-close">&#10006</span></div>',closeHandler:".flash-message-close",default:{type:"success",time:14e3,sticky:!1,fadeOut:1e3,closable:!0,scrollTo:!0,html:!1},typesDefault:{error:{sticky:!0},danger:{sticky:!0}}},c=i("<div/>");function d(n){var e=l.typesDefault[n.type];e&&i.extend(n,i.extend({},e,n)),t.forEach(function(e){var t=n[e];n[e]=void 0===t?l.default[e]:t}),l.convert&&l.convert(n)}function e(){o=window.innerHeight||document.documentElement.clientHeight,window.innerWidth||document.documentElement.clientWidth}function s(){l.method.apply(this,arguments)}function n(){a=a||i(l.container),i(l.appendTo).append(a),l.window&&(window.flash=l.window.flash)}s.setting=l,s.formatOptions=d,l.method=s.defaultMethod=function(e,t){function n(){r.remove()}d(t=t||{}),t.html||(s=e,e=c.text(s).html());var s,r=i(l.message.replace("{message}",e).replace("{type}",t.type)).appendTo(a);t.sticky||r.delay(t.time).fadeOut(t.fadeOut,n),t.closable?r.find(l.closeHandler).addBack(l.closeHandler).bind("click",n):r.addClass("nonclosable"),t.scrollTo&&((s=r[0].getBoundingClientRect()).top<0||s.top>o)&&r[0].scrollIntoView()},window.flash=s,["error","danger","info","notice","success","warning","alert"].forEach(function(n){s[n]=function(e,t){(t=t||{}).type=n,s(e,t)}}),i(window).resize(e),i(document).ready(e).ready(n).bind("page:load turbolinks:load",n)})(jQuery);let config=new Config(default_delay,settings_prefix,default_line_format);function show_pause_signal(){jQuery(".loader-container").addClass("hidden"),jQuery(".pause-container").removeClass("hidden"),jQuery("#pause-button").addClass("hidden"),jQuery("#resume-button").removeClass("hidden"),jQuery("#processing-panel-title").text("PAUSED...")}function show_resume_signal(){jQuery(".pause-container").addClass("hidden"),jQuery(".loader-container").removeClass("hidden"),jQuery("#resume-button").addClass("hidden"),jQuery("#pause-button").removeClass("hidden"),jQuery("#processing-panel-title").text("PROCESSING...")}function update_total_sent(){var e=jQuery("#total-messages-sent"),t=+e.text();e.text(1+t)}function stop_sending(e,t,n,s){e.stop(),t&&show_alert(t,n),jQuery("#processing-panel-title").text("PROCESSING ENDED"),jQuery("#pause-button").addClass("hidden"),jQuery("#resume-button").addClass("hidden"),config.server.http.hideLoader(),config.server.http.hide_sending_loader(),enable_stage_buttons(),show_restart_and_log_btn(s)}function successfull_end(e){stop_sending(e,"Sending session has ended","info",!0)}function interrupted_end(){return stop_sending("Sending session interrupted","warning",!1)}function display_new_balance(e){var t=!!e.hasOwnProperty("balance")&&e.balance||"Balance: NA";return jQuery("#current-balance").removeClass("hidden").text(t),e}function display_results(e){let t;var n;return e&&(n=e.hasOwnProperty("lead")?`<span class="lead_in_result">${e.lead}</span>: `:"",(e.result?(t=+jQuery("#accepted-messages").text(),jQuery("#accepted-messages").text(t+1),jQuery("#accepted-messages-tab")):(t=+jQuery("#failed-messages").text(),jQuery("#failed-messages").text(t+1),jQuery("#failed-messages-tab"))).prepend(n+e.description+"<br>")),e}function show_composed_msg(e){var t,n;return e&&(t=e.hasOwnProperty("message")?e.message:null,n=e.hasOwnProperty("lead")?`<span class="lead_in_result">${e.lead}</span>: `:"")&&t&&jQuery("#composed-message").html(n+t),e}function init_for_start_of_sending_session(){config.processing.total_sent=0,config.processing.current_msg_pointer=-1,config.processing.current_index_pointer=0,config.server.http.show_sending_loader(),jQuery("#total-available-messages").text(config.get_entry("total_leads")),disable_stage_buttons(),hide_restart_and_get_send_log_btn(),jQuery("#accepted-messages-tab, #failed-messages-tab, #composed-message").html(""),jQuery("#failed-messages").text("0"),jQuery("#accepted-messages").text("0"),jQuery("#total-messages-sent").text("0")}function start_sending(){if(!invalid_data_found()){var e=new Packet(config);let t=new Gauge(config.get_entry("delay"));init_for_start_of_sending_session(),new Streamer({generator:e.sequencer(get_leads()),stopButton:document.querySelector("#stop-button"),pauseButton:document.querySelector("#pause-button"),resumeButton:document.querySelector("#resume-button"),delayTime:config.get_entry("delay"),sendMessage:e=>config.server.http.send_message(e),onMessageSent:e=>{e=e.data;display_new_balance(e),show_composed_msg(e),display_results(e),update_total_sent()},onStart:()=>{jQuery("#pause-button").removeClass("hidden"),jQuery("resume-button").addClass("hidden")},onError:e=>{show_alert(e,"error")},onStreamEnd:()=>{},onCancel:()=>{},onTick:e=>{t.updateUI(e)},onPause:()=>{show_pause_signal()},onResume:()=>{show_resume_signal()},onEnd:()=>{successfull_end(t)}}).start()}}function index_action(e,...t){let n={get_available_providers:()=>config.server.get_available_providers(),get_provider_fields:()=>config.server.get_provider_fields(),get_sending_summary:get_sending_summary,start_sending:start_sending},s=e.data("element-action");s&&n.hasOwnProperty(s)&&setTimeout(()=>{n[s](...t)},0)}function run_js_function(e,...s){if(e){let t=e.split("."),n=window[t[0]];for(let e=1;e<t.length;e++)n=n[t[e]];return n.call(window,...s)}}function dec2hex(e){return("0"+e.toString(16)).substring(-2)}function show_alert(e,t){t=t||"error",flash(e,{type:t,closable:!0})}function setup_rotating_messages(e){config.processing.message_container=[];for(var t=0;t<e.length;t++)e[t].value.trim()&&config.processing.message_container.push(e[t].value)}function setup_index_links(e){if(config.processing.index_container=[],e.length){e=e[0].value.trim();if(e)for(var t=e.split("\n"),n=0;n<t.length;n++)t[n].trim()&&config.processing.index_container.push(t[n].trim())}}function prepare_summary_panel(){var e=jQuery(".templates").find("table#fs-preview");if(e.length){for(var t of config.reviewable_fields()){var n="boolean"==typeof(n=config.get_entry(t))?yes_no[n]:n;e.find(".review-"+t).text(n)}jQuery("table#preview-content").html(e.html())}}function enable_stage_buttons(){jQuery(".stage-link").removeClass("is-disabled")}function disable_stage_buttons(){jQuery(".stage-link").addClass("is-disabled")}function hide_restart_and_get_send_log_btn(){jQuery(".restart-button").addClass("hidden"),jQuery(".show-provider-log-button").addClass("hidden"),jQuery("#stop-button").removeClass("hidden"),jQuery("#processing-panel-title").text("Processing...")}function show_restart_and_log_btn(e){jQuery(".stop-button").addClass("hidden"),jQuery(".restart-button").removeClass("hidden"),e&&!!(e=config.get_entry("add_ons")).hasOwnProperty("live_log_available")&&e.live_log_available&&jQuery(".show-provider-log-button").removeClass("hidden"),jQuery("#processing-panel-title").text("End Of Processing")}function get_sending_summary(){let n={};jQuery.each(jQuery("form#msform").serializeArray(),function(e,t){n[t.name]=t.value,config.set_entry(t.name,t.value)}),config.set_entry("sender_id",n.sender_id),config.set_entry("delay",n.delay),config.set_entry("line_format",n.line_format),config.set_entry("total_leads",get_leads().length),config.set_entry("provider",n.service_provider),config.set_entry("index_roll_in",n.index_roll_in),config.set_entry("message_container",(e=>{var t,n=[];for(t of[1,2,3,4])e.hasOwnProperty("message-"+t)&&e["message-"+t].trim()&&n.push(e["message-"+t]);return n})(n)),config.set_entry("index_container",split_lines(jQuery("#indexes-container").val())),config.set_entry("total_messages",config.get_entry("message_container").length),config.set_entry("total_indexes",config.get_entry("index_container").length),config.server.http.showLoader(),setTimeout(()=>{prepare_summary_panel(),config.server.http.hideLoader()},1e3)}function construct_form_input_field(e,t,n,s,r){let i;if(s){for(var a in i=`<select id="${e}" name="${e}" data-keyname="${t}">`,s){var o=s[a]==n?" selected ":"";i+=`<option value="${s[a]}" ${o}>${a}</option>`}i+="</select>"}else i=`<input type="${"password"==t?"password":"text"}" id="${e}" name="${e}" data-keyname="${t}" 
                 placeholder="${t}" value="${n}"/>`;return jQuery(document).on("keyup change","#"+e,activate_provider_account_fetch_btn),`<div class="provider-input-group">${i}
                <div class="provider-input-help">${r}</div>
            </div>`}function stringify_provider_input_fields(e){let t=['<h2 class="fs-title" style="color:red;">Provider Settings are unavailable or could not be fetched</h2>'];if(config.set_page_accessibility_by_jump("provider-settings",!0),e)if(Object.keys(e).length){t=[];var n,s=config.get_entry("fields"),r={},i=config.get_entry("settings_prefix");for(n in e){var a,o=e[n],l=o.hasOwnProperty("value")?o.value:null,c=o.hasOwnProperty("options")&&Object.keys(o.options).length?o.options:null,o=o.hasOwnProperty("help")?o.help:"";null!==l&&(s[a=i+n]={key:n,value:l},r[n]=l,t.push(construct_form_input_field(a,n,l,c,o)))}config.set_entry("fields",s),config.set_entry("settings",r)}else show_alert("The returned Config Data for this Service provider is empty","warning");else show_alert("Could not retrieve service Provider's config data");return t.join("<br>")}function extract_provider_info_and_add_ons(e){var t,n,s={};e&&Object.keys(e).length&&(t=e.hasOwnProperty("global_info")?e.global_info:null,s=e.hasOwnProperty("add_ons")?e.add_ons:{},t&&(e=t.hasOwnProperty("help_text")?t.help_text:null)&&show_alert(e,"success"),Object.keys(s).length)&&(t=jQuery("#sender_id"),e={false:"This provider does not support Sender-IDs",true:"Sender-ID"},n=!!s.hasOwnProperty("supports_sender_id")&&s.supports_sender_id,config.set_entry("add_ons",s),t.val(n?"SMSINFO":"").attr("disabled",!n).attr("placeholder",e[n]))}function prepare_provider_fields(e){config.set_entry("provider",e.provider),jQuery("#selected-service-provider").text(config.get_entry("provider"));var t=e&&e.hasOwnProperty("input_fields")?e.input_fields:"",e=(extract_provider_info_and_add_ons(e),stringify_provider_input_fields(t)),t=get_provider_settings_html(e);jQuery(".provider-account-and-settings-container").html(t).removeClass("hidden")}function get_provider_settings_html(e){var t=config.get_entry("add_ons"),t=!(!t||!t.hasOwnProperty("account_info_available"))&&t.account_info_available;let n='<div id="provider-settings-container" style="width: '+(t?"70%":"100%")+';">'+e+"</div>";return jQuery(".provider-account-and-settings-container").css("display","block"),t&&(jQuery(".provider-account-and-settings-container").css("display","flex"),n+=`<div class="provider-account-info-container">
                         <div class="provider-account-info">
                             <h2 class="fs-title" style="font-weight:bold; color: #ca0000c9;">
                                 Provider account info not available
                             </h2>
                             <p style="font-size:9px;text-align:center;">Fill in the fields on the left side to authenticate first</p>
                         </div>                
                         <input type="button" class="action-button specific-provider-account-info-btn is-disabled" value="Account Info" style="background:#06aeabba;"/>
                     </div>`),n}function activate_provider_account_fetch_btn(e){if(jQuery(".specific-provider-account-info-btn").addClass("is-disabled"),Object.keys(config.get_entry("fields")).length){let e=!0;var t,n=config.get_entry("fields"),s=config.get_entry("settings");for(t in n){var r=String(jQuery("#"+t).val()).trim();if(n[t].value=r,!(s[n[t].key]=r)){e=!1;break}}config.set_entry("fields",n),config.set_entry("settings",s),e&&jQuery(".specific-provider-account-info-btn").removeClass("is-disabled")}}function remove_provider_account_info(e){jQuery(".provider-account-info").html('<h2 class="fs-title" style="font-weight:bold; color: #ca0000c9;">Provider account info not available</h2><p style="font-size:9px;text-align:center;">Fill in the fields on the left side to authenticate first</p>'),jQuery(".specific-provider-account-info-btn").addClass("is-disabled"),e&&show_alert(e)}function display_provider_account_info(e){let t='<h2 class="fs-title" style="font-weight:bold; color: #ca0000c9;">Account data could not be parsed</h2>';if(Object.keys(e).length){for(var n in t='<table class="dynamic-account-info-table"><tbody>',e)t+=`<tr>
                          <td>${n}</td>
                          <td>${e[n]}</td>
                        </tr>`;t+="</tbody></table>"}jQuery(".provider-account-info").html(t),jQuery(".specific-provider-account-info-btn").addClass("is-disabled")}function invalid_data_found(){var e,t,n,s=!1;function r(e,t){return!(!e.val()&&!e.data("optional")&&(show_alert("Data on page "+t+" still needs to be updated"),jQuery(`i.stage-btn[data-page="${t}"]`).trigger("click"),s=!0))}return["local-settings","tags-settings"].forEach(n=>{s||jQuery("fieldset#"+n).find("input:not(.action-button)").each((e,t)=>{if(!r(jQuery(t),n))return!1}),s||jQuery("fieldset#"+n).find("select").each((e,t)=>{if(!r(jQuery(t),n))return!1}),s||(config.get_entry("total_leads")<1?(show_alert("Data on the leads page still needs to be updated"),jQuery('i.stage-btn[data-page="leads"]').trigger("click"),s=!0):parseInt(config.get_entry("index_roll_in"))<1&&(show_alert("Index roll in must have a valid value higher than 0"),jQuery('i.stage-btn[data-page="indexes"]').trigger("click"),s=!0))}),s||(e=config.get_entry("total_messages"),t=config.get_entry("total_indexes"),n=config.get_entry("msg_url_mode"),e?t||"index"==n&&(show_alert("You have chosen to apply indexing but no indexes were found"),jQuery('i.stage-btn[data-page="indexes"]').trigger("click"),s=!0):(show_alert("Messages container is empty"),jQuery('i.stage-btn[data-page="messages"]').trigger("click"),s=!0)),s}function split_lines(e){return(e=e.trim())?e.split("\n"):[]}function get_leads(){var e=split_lines(jQuery("#leads-container").val());return jQuery("#leads-count").text(e.length),e}(o=>{o.fn.numberedtextarea=function(e){var s=o.extend({color:null,borderColor:null,class:null,allowTabChar:!1},e);return this.each(function(){if("textarea"!==this.nodeName.toLowerCase())return!1;var a,e,t,n;e=this,t=o('<div class="numberedtextarea-wrapper"></div>').insertAfter(e),o(e).detach().appendTo(t),(a=o(a=this)).parents(".numberedtextarea-wrapper"),e=parseFloat(a.css("padding-left")),t=parseFloat(a.css("padding-top")),parseFloat(a.css("padding-bottom")),n=o('<div class="numberedtextarea-line-numbers"></div>').insertAfter(a),a.css({paddingLeft:e+n.width()+"px"}).on("input propertychange change keyup paste",function(){var e=a,t=(e=o(e)).parent().find(".numberedtextarea-line-numbers"),n=e.val().split("\n").length,s=parseFloat(e.css("padding-bottom"));for(t.find(".numberedtextarea-number").remove(),i=1;i<=n;i++){var r=o('<div class="numberedtextarea-number numberedtextarea-number-'+i+'">'+i+"</div>").appendTo(t);i===n&&r.css("margin-bottom",s+"px")}}).on("scroll",function(){var e;(e=o(e=a)).parent().find(".numberedtextarea-line-numbers").scrollTop(e.scrollTop())}),n.css({paddingLeft:e+"px",paddingTop:t+"px",lineHeight:a.css("line-height"),fontFamily:a.css("font-family"),width:n.width()-e+"px"}),a.trigger("change"),s.allowTabChar&&o(this).allowTabChar()}),this},o.fn.allowTabChar=function(){return this.jquery&&this.each(function(){var e;1==this.nodeType&&("textarea"==(e=this.nodeName.toLowerCase())||"input"==e&&"text"==this.type)&&(o(e=this).on("keydown",function(e){var t,n,s;if(9==e.which)return e="\t",(t=this).focus(),"number"==typeof t.selectionStart?(s=t.value,n=t.selectionStart,t.value=s.slice(0,n)+e+s.slice(t.selectionEnd),t.selectionEnd=t.selectionStart=n+e.length):void 0!==document.selection&&((s=document.selection.createRange()).text=e,s.collapse(!1),s.select()),!1}),o(e).on("keypress",function(e){if(9==e.which)return!1}))}),this}})(jQuery),(n=>{var s,r,i,a,o,t,l=n(".tabs li a");get_and_dump_leads=function(e){config.server.get_wp_leads(e).then(e=>{var t,e=e.data.join("\n");"replace"===n("#leads_append_mode").find("option:selected").val()?n("#leads-container").val(e):(t=n("#leads-container").val().trim(),n("#leads-container").val(t+"\n"+e))})},n(".lined").numberedtextarea(),n(".panel-footer").html(localizer.copyright_data),n("#service_provider").on("change",function(){config.set_entry("add_ons",{}),config.set_entry("provider",n(this).val()),n("#selected-service-provider").text(config.get_entry("provider")),config.set_page_accessibility_by_jump("provider",!0),config.set_page_accessibility_by_jump("provider-settings",!1)}),n("#use_shortner_code_as_route_arg").on("change",function(){config.set_entry("use_shortner_code_as_route_arg",n(this).val())}),n("#full_country_name").on("change",function(){var e=n("#full_country_name option:selected");config.set_entry("sending_target_country_code",e.val()),config.set_entry("full_country_name",e.text()),config.set_entry("dial_code_length",e.data("dial_code_length")),config.set_page_accessibility_by_jump("local-settings",!0)}),n("#msg_url_mode").on("change",function(){var e=n(this).val();switch(e){case"shortner":n("#language-indicator").attr("disabled",!1),n("#indexes-container").attr("disabled",!0),n("#index_roll_in").attr("disabled",!0);break;case"index":n("#language-indicator").attr("disabled",!1),n("#indexes-container").attr("disabled",!1),n("#index_roll_in").attr("disabled",!1);break;default:n("#language-indicator").attr("disabled",!0),n("#indexes-container").attr("disabled",!0),n("#index_roll_in").attr("disabled",!0)}config.set_entry("indexing_method",e)}),n("#leads_input_source").on("change",function(){var e=n(this),t=e.find("option:selected").data("info");n("#leads_input_selection_title").text(t).css("color","blue"),get_and_dump_leads(e.val())}),n(document).on("click",".specific-provider-account-info-btn",function(e){e.preventDefault(),Object.keys(config.get_entry("settings"))?config.server.get_account_info().then(display_provider_account_info).catch(remove_provider_account_info):remove_provider_account_info("Some Provider fields are missing or invalid")}),n("#upload-new-plugin-btn").click(function(){document.getElementById("zip-file-input").click()}),n("#zip-file-input").change(function(){var e,t=this.files[0];t&&(t.name.endsWith(".zip")?((e=new FormData).append("zip_file",t),config.server.install_plugin(e).then(e=>{e&&setTimeout(()=>{show_alert(e,"success"),jQuery("#provider-tab").trigger("click")},1e3)})):show_alert("Only zip files are allowed","error"))}),n("#macleen-selected-purchasable-plugin-purchase").click(function(){var e=n(this).attr("data-selected-plugin"),t=n(this).attr("data-plugin-location");e&&t?window.open(t+"/"+e,"_blank"):show_alert("Please select a plugin in the purchasable area first","warning")}),n("#delete_log_file").on("click",function(){let e=n(this).attr("data-logDate");e?config.server.delete_log_by_date(e).then(()=>{Logging.reset(),show_alert(`Log File for ${e} successfully deleted`,"success")}):show_alert("Invalid log file identifier","error")}),n("#delete_analytics_file").on("click",function(){var e=n(this).attr("data-filepath");e?config.server.delete_analytics_by_path(e).then(()=>{Analytics.reset(),show_alert(`Hashed-Dump with index ${dump_index} successfully deleted`,"success")}):show_alert("Unknown hash-index or invalid file path","error")}),n(".sound-control").on("click",function(){var e;n(".loader-container").is(":visible")&&(e=document.getElementById("sound-track"),config.set_entry("sound_is_on",!config.get_entry("sound_is_on")),config.get_entry("sound_is_on")?n("#loader").addClass(()=>(n("#loader").removeClass(()=>(e.play(),"zz_loader")),"loader-md")).attr("src",localizer.plugin_url+"assets/admin/img/loader.gif"):n("#loader").addClass(()=>(n("#loader").removeClass(()=>(e.pause(),"loader-md")),"zz_loader")).attr("src",localizer.plugin_url+"assets/admin/img/zz_loader.gif"))}),n(".btn").on("click",function(){n(".btn").toggleClass("close-btn"),n(".sidebar").toggleClass("sidebar-open")}),n(".next").click(function(){if(t)return!1;t=!0,n(".fs").removeClass("current-fs"),s=n(this).parent(),r=n(this).parent().next();var e=s.prop("id");["provider","provider-settings"].includes(e)||config.set_page_accessibility_by_jump(e,!0),n("#progressbar li").eq(n("fieldset").index(r)).addClass("active"),r.addClass("current-fs"),r.show(),s.animate({opacity:0},{step:function(e,t){a=50*e+"%",o=1-e,s.css({position:"absolute"}),r.css({position:"relative",left:a,opacity:o})},duration:600,complete:function(){s.hide(),t=!1,index_action(r,s,r)},easing:"easeInOutBack"})}),n(".previous").click(function(){if(t)return!1;t=!0,n(".fs").removeClass("current-fs"),s=n(this).parent(),i=n(this).parent().prev(),n("#progressbar li").eq(n("fieldset").index(s)).removeClass("active"),n("#progressbar li").eq(n("fieldset").index(i)).addClass("active"),i.addClass("current-fs"),i.show(),s.animate({opacity:0},{step:function(e,t){right=50*e+"%",o=1-e,s.css({position:"absolute"}),i.css({position:"relative",right:right,opacity:o})},duration:600,complete:function(){s.hide(),t=!1,index_action(i,s,i)},easing:"easeInOutBack"})}),n(".stage-btn").click(function(){n(this).data("page");if(t)return!1;t=!0;var e=n(this).data("target");s=n(".current-fs").first(),n(".fs").removeClass("current-fs"),r=n(e),n("#progressbar li").eq(n("fieldset").index(r)).addClass("active"),r.addClass("current-fs"),r.show(),s.animate({opacity:0},{step:function(e,t){a=50*e+"%",o=1-e,s.css({position:"absolute"}),r.css({position:"relative",left:a,opacity:o})},duration:600,complete:function(){s.hide(),t=!1,index_action(r,s,r)},easing:"easeInOutBack"})}),n(".tab").on("click",function(){n(".tab-label").removeClass("active-tab"),n(this).find("label").addClass("active-tab")}),n(".stop-button").on("click",function(e){e.preventDefault(),n("#stop-button").val("Stopping..."),config.set_entry("halted_by_user",!0)}),n(".restart-button").on("click",function(){n("a.provider-settings-stage").find("i.stage-btn").trigger("click"),n("ul#progressbar").children("li").removeClass("active"),n("ul#progressbar").children("li").removeClass("active"),n("ul#progressbar").children().eq(0).addClass("active"),n("ul#progressbar").children().eq(1).addClass("active")}),l.click(function(){var e=this.hash.replace("/","");l.removeClass("active"),n(this).addClass("active"),n("#content").find("p").addClass("hidden"),n(e).removeClass("hidden")});let c=document.querySelectorAll(".responsive-tab-btn"),d=document.querySelectorAll(".responsive-tab-panel");c.forEach(e=>{e.addEventListener("click",()=>{c.forEach(e=>e.classList.remove("active")),e.classList.add("active"),d.forEach(e=>e.classList.remove("active")),document.getElementById(e.dataset.tab).classList.add("active")})}),setTimeout(()=>index_action(n("#provider.fs")),100)})(jQuery);class Streamer{constructor(e){this.cycle_tick=0,this.settings=e,this.generator=e.generator(),this.delayTime=1e3*e.delayTime,this.pause$=new rxjs.BehaviorSubject(!1),this.resume$=new rxjs.Subject,this.stop$=new rxjs.Subject,this.subscription=new rxjs.Subscription,this.isStopped=!1,this.isStreamComplete=!1,this.setupButtons()}setupButtons(){this.settings.stopButton&&this.settings.stopButton.addEventListener("click",()=>this.stop()),this.settings.pauseButton&&this.settings.pauseButton.addEventListener("click",()=>this.pause()),this.settings.resumeButton&&this.settings.resumeButton.addEventListener("click",()=>this.resume())}#createMessageStream(){return new rxjs.Observable(n=>{let s=()=>{var e,t;this.isStopped?n.complete():this.pause$.getValue()?(console.log("â¸ï¸ Paused. Waiting for resume..."),this.resume$.pipe(rxjs.take(1)).subscribe(()=>{console.log("â–¶ï¸ Resumed!"),s()})):({value:e,done:t}=this.generator.next(),t?(n.complete(),this.settings.onStreamEnd(),this.isStreamComplete=!0):this.settings.sendMessage(e).then(e=>{this.settings.onMessageSent(e),this.cycle_tick=0,this.isStopped||this.isStreamComplete||(this.pause$.getValue()?this.resume$.pipe(rxjs.take(1)):rxjs.timer(this.delayTime)).subscribe(()=>s())}).catch(e=>{console.error("âŒ Message sending error:",e),this.settings.onError(e),n.error(e)}))};s()})}start_ticker(){return this.tick_handle=setInterval(()=>this.settings.onTick(this.cycle_tick++),1400),this}stop_ticker(){return clearInterval(this.tick_handle),this}start(){this.isStopped=!1,this.isStreamComplete=!1,this.settings.onStart();var e=this.#createMessageStream().pipe(rxjs.takeUntil(this.stop$));this.start_ticker().subscription.add(e.subscribe({next:e=>console.log("ðŸ“© Processed message:",e),error:e=>{console.error("âŒ Error in stream:",e),this.settings.onError(e),this.stop()},complete:()=>{console.log("âœ… Streaming finished."),this.settings.onStreamEnd(),this.stop()}}))}stop(){this.isStopped=!0,this.stop$.next(),this.cleanup(),this.settings.onEnd()}pause(){this.pause$.next(!0),this.settings.onPause(),this.stop_ticker()}resume(){this.pause$.next(!1),this.resume$.next(),this.settings.onResume(),this.start_ticker()}cleanup(){this.stop_ticker(),this.subscription.unsubscribe(),this.subscription=new rxjs.Subscription}}document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("form").forEach(n=>{n.addEventListener("submit",function(e){var t=n.querySelector('input[name="mobile_number"]');t&&((t=t.value.trim())?/^\+?[1-9]\d{1,14}$/.test(t)||(e.preventDefault(),show_alert("SMS-Bulk-Sender: Invalid mobile number format.")):(e.preventDefault(),show_alert("SMS-Bulk-Sender: Mobile number is required.")))})})});let Logging=(n=>{let r=[],s=1,i=10,a="",o=localizer.license||"Basic",l=document.querySelector("#dataTable tbody");function e(){config.server.get_available_log_files().then(e=>{e=(t=>{if(t.length){let e='<table class=""><tbody>';e+=`
                    <tr>
                        <th>Date</th>
                        <th>Created at</th>
                        <th>Updated at</th>
                        <th>Total messages</th>
                        <th>Successful messages</th>
                        <th>Failed messages</th>                    
                    </tr>`;for(var n of t)e+=`
                            <tr class="row-clickable get-log-file-by-date" data-logdate="${n.date}">
                                <td>${n.date}</td>
                                <td>${n.header.created_at}</td>
                                <td>${n.header.updated_at}</td>
                                <td>${n.header.total_number_of_lines}</td>
                                <td>${n.header.successful_messages}</td>
                                <td>${n.header.failed_messages}</td>
                            </tr>`;return e+="</tbody></table>"}return'<div class="error">[ 404 ] - No log files were found</div>'})(e.data);n("#available_log_files").html(e),document.querySelectorAll(".get-log-file-by-date").forEach(e=>{e.addEventListener("click",function(){var t;t=this.dataset.logdate,"Pro"==o?(r="",s=1,n("#log_file_content").addClass("hidden"),config.server.get_log_by_date(t).then(e=>{r=e.data.raw_data.map(e=>{try{var t=e.trim().replace(/\r$/,"");return JSON.parse(t)}catch(e){return null}}).filter(e=>null!==e),a=t;{let n=document.getElementById("tableHeader");n.innerHTML="",0<r.length&&["Provider","SenderID","Name","Recipient","Sent","Balance"].forEach(e=>{var t=document.createElement("th");t.innerText=e.replace(/_/g," "),n.appendChild(t)})}c(s,a),n("#log_file_content").removeClass("hidden")})):show_alert("This functionality is available in the Pro version only","warning")})})})}function c(e,t){l.innerHTML="",document.querySelector("#delete_log_file").dataset.logdate=t;var n=(e-1)*i,s=n+i;r.slice(n,s).forEach(s=>{let r=document.createElement("tr");if(r&&(r.classList.add("row-clickable"),r.addEventListener("click",()=>{{var n=s;let e=document.getElementById("popup"),t=document.getElementById("popupData");t.innerHTML=(e=>{let t='<table class="table"><tbody>';for(var n of Object.keys(e))if(["request","response"].includes(n)){t+=`
                        <tr>
                            <td colspan="2"><span style="color:yellow">${n.toUpperCase()}</span></td>
                        </tr>
                    `;for(var[s,r]of Object.entries(e[n]))t+=`
                        <tr>
                            <th>${s}</th>
                            <td>${r}</td>
                        </tr>
                    `}return t+="</tbody></table>"})(n),e.style.display="block",setTimeout(()=>{e.classList.add("open")},10)}}),s.hasOwnProperty("response"))&&s.hasOwnProperty("request")){var e=s.response,t=s.request;let n={Provider:e.hasOwnProperty("provider")?e.provider:"NA",SenderID:t.hasOwnProperty("sender_id")?t.sender_id:"NA",Name:t.hasOwnProperty("full_name")?(t=t.full_name,i=20,t.length>i?t.slice(0,i)+"...":t):"NA",Recipient:e.hasOwnProperty("lead")?e.lead:"NA",Sent:e.hasOwnProperty("result")?e.result?'<span class="success">Success</span>':'<span class="failed">Failed</span>':"NA",Balance:e.hasOwnProperty("balance")?'<span class="warning">'+e.balance+"</span>":"NA"};Object.keys(n).forEach(e=>{var t=document.createElement("td");t.innerHTML=n[e],r.appendChild(t)}),l.appendChild(r)}var i}),document.getElementById("sending-date").innerText=t||"N/A",document.getElementById("pageInfo").innerText=`Page ${e} of `+Math.ceil(r.length/i)}try{document.getElementById("prevPage").addEventListener("click",()=>{1<s&&c(--s,a)}),document.getElementById("nextPage").addEventListener("click",()=>{s<Math.ceil(r.length/i)&&c(++s,a)})}catch(e){}return{reset:function(){l.innerHTML="",n("#log_file_content").addClass("hidden"),e()},closePopup:function(){let e=document.getElementById("popup");e.classList.remove("open"),e.classList.add("closing"),setTimeout(()=>{e.style.display="none",e.classList.remove("closing")},300)}}})(jQuery),Analytics=(s=>{let r=[],i=1,a=10,o=localizer.license||"Basic",l=document.querySelector("#dataTable tbody");function e(){config.server.get_available_analytics_files().then(e=>{e=(t=>{if(t.length){var n;let e='<table class=""><tbody>';e+=`
                    <tr>
                        <th>Compaign Date</th>
                        <th>Updated at</th>
                        <th>Size</th>
                    </tr>`;for(n of t)e+=`
                            <tr class="row-clickable get-analytics-file-by-path" data-sendingDate="${n.file}" data-filePath="${n.path}">
                                <td>${n.file}</td>
                                <td>${n.updated_at}</td>
                                <td>${n.size}</td>
                            </tr>`;return e+="</tbody></table>"}return'<div class="error">[ 404 ] - No data was found</div>'})(e.data);s("#available_analytics_files").html(e),document.querySelectorAll(".get-analytics-file-by-path").forEach(e=>{e.addEventListener("click",function(){var t,n;t=this.dataset.sendingdate,n=this.dataset.filepath,"Pro"==o?(r="",i=1,s("#analytics_file_content").addClass("hidden"),config.server.get_analytics_file_by_path(n).then(e=>{r=e.data;{let n=document.getElementById("tableHeader");n.innerHTML="",0<r.length&&["HashIndex","Recipient","Name","Country","Clicked"].forEach(e=>{var t=document.createElement("th");t.innerText=e,n.appendChild(t)})}c(i),document.querySelector("#delete_analytics_file").dataset.filepath=n,document.querySelector("#sending_date").innerText=t,s("#analytics_file_content").removeClass("hidden")})):show_alert("This functionality is available in the Pro version only","warning")})})})}function c(e){l.innerHTML="";var t=(e-1)*a,n=t+a;r.slice(t,n).forEach(s=>{let r=document.createElement("tr");if(r&&(r.classList.add("row-clickable"),r.addEventListener("click",()=>{{var n=s;let e=document.getElementById("popup"),t=document.getElementById("popupData");t.innerHTML=(e=>{let t='<table class="table"><tbody>';for(var n of Object.keys(e))if(["data","meta_data"].includes(n)){t+=`
                        <tr>
                            <td colspan="2"><span style="color:yellow">${n.toUpperCase()}</span></td>
                        </tr>
                    `;for(var[s,r]of Object.entries(e[n]))t+=`
                        <tr>
                            <th>${s}</th>
                            <td>${r}</td>
                        </tr>
                    `}return t+="</tbody></table>"})(n),e.style.display="block",setTimeout(()=>{e.classList.add("open")},10)}}),s.hasOwnProperty("data"))&&s.hasOwnProperty("meta_data")){var e=s.data,t=Object.entries(s.meta_data).length?"Yes":"No";let n={HashIndex:s.hasOwnProperty("index")?s.index:"NA",Recipient:e.hasOwnProperty("recipient")?e.recipient:"NA",Name:e.hasOwnProperty("full_name")?(i=e.full_name,a=20,i.length>a?i.slice(0,a)+"...":i):"NA",Country:e.hasOwnProperty("sending_target_country_code")?e.sending_target_country_code:"NA",Clicked:"Yes"==t?'<span class="success">Yes</span>':'<span class="failed">No</span>'};Object.keys(n).forEach(e=>{var t=document.createElement("td");t.innerHTML=n[e],r.appendChild(t)}),l.appendChild(r)}var i,a}),document.getElementById("pageInfo").innerText=`Page ${e} of `+Math.ceil(r.length/a)}try{document.getElementById("prevPage").addEventListener("click",()=>{1<i&&c(--i)}),document.getElementById("nextPage").addEventListener("click",()=>{i<Math.ceil(r.length/a)&&c(++i)})}catch(e){}return{reset:function(){l.innerHTML="",s("#analytics_file_content").addClass("hidden"),e()},closePopup:function(){let e=document.getElementById("popup");e.classList.remove("open"),e.classList.add("closing"),setTimeout(()=>{e.style.display="none",e.classList.remove("closing")},300)}}})(jQuery);class Timer{static TIMER_PORTION=.05;constructor(e,t,n){this.timer_instance=null,this.dom_timer=e,this.dom_countdown=t,this._delay=n,this.cycle_count_down=n}set delay(e){if(isNaN(e))throw new Error("Delay must be a whole number");this._delay=e}get delay(){return this._delay}#evoluate(e){this.dom_timer.css("width",(e<=0?0:100<=e?100:e)+"%"),this.dom_countdown.text(Number(this.cycle_count_down).toFixed(0))}reset(){this.cycle_count_down=this._delay,this.#evoluate(0)}stop(){clearInterval(this.timer_instance),this.reset()}#timer_cycle(...s){let r=this;return this.reset(),new Promise(e=>{let t=100/(r._delay/Timer.TIMER_PORTION),n=0;clearInterval(r.timer_instance),r.reset(),r.timer_instance=setInterval(function(){n+=t,r.#evoluate(n),r.cycle_count_down-=Timer.TIMER_PORTION,100<=n&&(clearInterval(r.timer_instance),e(...s))},1e3*Timer.TIMER_PORTION)})}run_timer_cycle(e,...t){this.#timer_cycle(...t).then(e)}}
//# sourceMappingURL=bundle.min.js.map
